#Dragonmaster
dragonmaster_progress_point_gain_effect = {
	if = {
		limit = { is_alive = yes }
		if = {
			limit = {
				NOT = { exists = var:dragonmaster_lifestyle_progress }
			}
			set_variable = {
				name = dragonmaster_lifestyle_progress
				value = $CHANGE$
			}
		}
		else = {
			change_variable = {
				name = dragonmaster_lifestyle_progress
				add = $CHANGE$
			}
		}
		save_scope_value_as = {
			name = dragonmaster_base_increase
			value = $CHANGE$
		}
		# Tooltips
		if = {
			limit = { scope:dragonmaster_base_increase <= 1 }
			custom_tooltip = dragon_rider_progress_towards_trait_1_tt
		}
		else_if = {
			limit = { scope:dragonmaster_base_increase = 2 }
			custom_tooltip = dragon_rider_progress_towards_trait_2_tt
		}
		else = { custom_tooltip = dragon_rider_progress_towards_trait_3_tt }
		#Random chance of additional point to increase unpredictability
		hidden_effect = {
			random = {
				chance = 30
				change_variable = {
					name = dragonmaster_lifestyle_progress
					add = $RANDOM_CHANGE$
				}
			}
		}
	}
}

dragonmaster_lifestyle_rank_up_check_effect = {
	save_scope_value_as = {
		name = dragon_scholar_activity
		value = $DRAGON_SCHOLAR$
	}
	save_scope_value_as = {
		name = dragon_hunter_activity
		value = $DRAGON_HUNTER$
	}
	if = {
		limit = {
			is_alive = yes
			has_trait = dragon_rider
			exists = var:dragonmaster_lifestyle_progress
		}
		add_trait = dragon_rider
	}
	# Dragon Scholar - for hatching/lore activities
	if = {
		limit = {
			is_alive = yes 
			exists = var:dragonmaster_lifestyle_progress
			has_trait = dragon_scholar
			scope:dragon_scholar_activity = yes
		}
		send_interface_toast = {
			title = dragon_scholar_xp_gain_message
			if = {
				limit = { var:dragonmaster_lifestyle_progress >= 7 }
				add_trait_xp = {
					trait = dragon_scholar
					track = dragon_hatching
					value = 15
				}
			}
			else_if = {
				limit = { var:dragonmaster_lifestyle_progress >= 5 }
				add_trait_xp = {
					trait = dragon_scholar
					track = dragon_hatching
					value = 10
				}
			}
			else_if = {
				limit = { var:dragonmaster_lifestyle_progress >= 3 }
				add_trait_xp = {
					trait = dragon_scholar
					track = dragon_hatching
					value = 5
				}
			}
			else = {
				add_trait_xp = {
					trait = dragon_scholar
					track = dragon_hatching
					value = 3
				}
			}
		}
	}
	# Dragon Hunter - for slaying/tracking activities
	else_if = {
		limit = {
			is_alive = yes 
			exists = var:dragonmaster_lifestyle_progress
			has_trait = dragon_hunter
			scope:dragon_hunter_activity = yes
		}
		send_interface_toast = {
			title = dragon_hunter_xp_gain_message
			if = {
				limit = { var:dragonmaster_lifestyle_progress >= 7 }
				add_trait_xp = {
					trait = dragon_hunter
					track = dragon_slayer
					value = 15
				}
			}
			else_if = {
				limit = { var:dragonmaster_lifestyle_progress >= 5 }
				add_trait_xp = {
					trait = dragon_hunter
					track = dragon_slayer
					value = 10
				}
			}
			else_if = {
				limit = { var:dragonmaster_lifestyle_progress >= 3 }
				add_trait_xp = {
					trait = dragon_hunter
					track = dragon_slayer
					value = 5
				}
			}
			else = {
				add_trait_xp = {
					trait = dragon_hunter
					track = dragon_slayer
					value = 3
				}
			}
		}
	}
	# Dragon Rider - default for riding/training activities
	else_if = {
		limit = {
			is_alive = yes
			exists = var:dragonmaster_lifestyle_progress
			has_trait = dragon_rider
		}
		send_interface_toast = {
			title = dragonmaster_xp_gain_message
			if = {
				limit = { var:dragonmaster_lifestyle_progress >= 7 }
				add_trait_xp = {
					trait = dragon_rider
					track = dragon_training
					value = 15
				}
			}
			else_if = {
				limit = { var:dragonmaster_lifestyle_progress >= 5 }
				add_trait_xp = {
					trait = dragon_rider
					track = dragon_training
					value = 10
				}
			}
			else_if = {
				limit = { var:dragonmaster_lifestyle_progress >= 3 }
				add_trait_xp = {
					trait = dragon_rider
					track = dragon_training
					value = 5
				}
			}
			else = {
				add_trait_xp = {
					trait = dragon_rider
					track = dragon_training
					value = 3
				}
			}
		}
	}
	set_variable = {
		name = dragonmaster_lifestyle_progress
		value = 0
	}
}